<h3 class="page">گالری تصاویر
<button  type="button" class="btn btn-info btn-sm pull-left" id="modalAdd" data-toggle="modal" data-target="#AddModal">
    درج اطلاعات جدید
    <span class="glyphicon glyphicon-plus"></span>
</button>
</h3>
<p></p>
<table class="table table-bordered table-striped table-hover" ng-click="text = false">
    <thead>
        <tr>
            <th>{{indexTitle}}</th>
            <th>{{titleTitle}}</th>
            <th>{{metaTitle}}</th>
            <th>
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortAscTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortDesc('orderList')" class="glyphicon glyphicon-arrow-up"></span>
                {{orderListTitle}}
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortDescTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortAsc('orderList')" class="glyphicon glyphicon-arrow-down"></span>
            </th>
            <th>
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortAscTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortDesc('createdAt')" class="glyphicon glyphicon-arrow-up"></span>
                {{createdAtTitle}}
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortDescTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortAsc('createdAt')" class="glyphicon glyphicon-arrow-down"></span>
            </th>
            <th>
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortAscTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortDesc('updatedAt')" class="glyphicon glyphicon-arrow-up"></span>
                {{updatedAtTitle}}
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortDescTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortAsc('updatedAt')" class="glyphicon glyphicon-arrow-down"></span>
            </th>
            <th>
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortAscTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortDesc('id')" class="glyphicon glyphicon-arrow-up"></span>
                {{idTitle}}
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortDescTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortAsc('id')" class="glyphicon glyphicon-arrow-down"></span>
            </th>
            <th>{{actionTitle}}</th>
        </tr>
    </thead>
    <tbody >
        <!--  Content Of Datatable      -->
        <tr ng-repeat="entity in content" id="{{entity.id}}" >
            <td>{{$index+1}}</td>
            <td class="td" id="{{ entity.id}}title"  value="{{entity.title}}" >
                <span id="{{entity.id}}title_TP">{{ entity.title | cut:true:25:' ...'}}</span>
                <textarea  name="title" class="{{ entity.id}}title form-control TextAreaContent" style="display: none">{{entity.title}}</textarea>
            </td>

            <td class="td" id="{{ entity.id}}meta"  value="{{entity.content}}" >
                {{ entity.meta | cut:true:25:' ...'  }}
                <textarea name="content" class="{{ entity.id}}meta form-control TextAreaContent" style="display: none">{{ entity.meta}}</textarea>
            </td>

            <td class="td" id="{{ entity.id}}order_list" value="{{entity.order_list}}" >
                <p id="{{entity.id}}order_list_OP">{{ entity.order_list}}</p>
                <textarea name="order_list" class="{{ entity.id}}order_list form-control TextAreaContent" style="display: none">{{ entity.order_list}}</textarea>
            </td>

            <td>{{ entity.created_at}}</td>

            <td>{{ entity.updated_at}}</td>

            <td><span ng-model="id">{{ entity.id}}</span></td>
            <td>
                <span style="cursor: pointer" onclick="Edit('{{entity.id}}','{{entity.title}}','{{entity.meta| nl2br}}','{{entity.order_list}}')" data-placement="bottom" title="{{editBtnTitle}}" id="BtnEdit" class="badge badge-success btnEditTitleTooltip "><span class="glyphicon glyphicon-edit"></span></span>
                <!--<button  onclick="Edit('{{entity.id}}','{{entity.title}}','{{entity.content| nl2br}}','{{entity.order_list}}','{{entity.ctg.id}}')" id="BtnEdit"  class="btn btn-success btn-sm">Edit</button>-->
                <span style="cursor: pointer"  data-placement="bottom" title="{{showBtnTitle}}" ng-click="show(entity.id)" data-toggle="modal" data-target="#ViewModal" class="badge badge-info btnShowTitleTooltip"><span class="glyphicon glyphicon-ok"></span></span>
                <span style="cursor: pointer" data-placement="bottom" title="{{deleteBtnTitle}}" onclick="Delete('{{ entity.id}}')" class="badge badge-error btnDeleteTitleTooltip"><span class="glyphicon glyphicon-remove"></span></span>
                
            </td>

        </tr>
    </tbody>
    <tfoot>
<tr>
            <th>{{indexTitle}}</th>
            <th>{{titleTitle}}</th>
            <th>{{metaTitle}}</th>
            <th>
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortAscTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortDesc('orderList')" class="glyphicon glyphicon-arrow-up"></span>
                {{orderListTitle}}
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortDescTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortAsc('orderList')" class="glyphicon glyphicon-arrow-down"></span>
            </th>
            <th>
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortAscTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortDesc('createdAt')" class="glyphicon glyphicon-arrow-up"></span>
                {{createdAtTitle}}
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortDescTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortAsc('createdAt')" class="glyphicon glyphicon-arrow-down"></span>
            </th>
            <th>
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortAscTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortDesc('updatedAt')" class="glyphicon glyphicon-arrow-up"></span>
                {{updatedAtTitle}}
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortDescTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortAsc('updatedAt')" class="glyphicon glyphicon-arrow-down"></span>
            </th>
            <th>
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortAscTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortDesc('id')" class="glyphicon glyphicon-arrow-up"></span>
                {{idTitle}}
                <span data-toggle="tooltip" data-placement="bottom" title="{{sortDescTitle}}" style="cursor: pointer" ng-show="true" ng-click="sortAsc('id')" class="glyphicon glyphicon-arrow-down"></span>
            </th>
            <th>{{actionTitle}}</th>
        </tr>
    </tfoot>
</table>
<!--<button class="btn btn-info" ng-repeat="number in CountPaginate" ng-click="paginate(number)">{{number}}</button>-->
<nav style="text-align: center">
    <ul class="pagination">
        <li>
            <a style="cursor: pointer;" id="paginatePreview" aria-label="Previous" ng-click="pagePreview()">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>
        <li class="paginate active" id="active"><a style="cursor: pointer;" ng-click="paginate(1)">1</a></li>
        <li ng-repeat="result in Allpaginate" class="paginate" ng-hide="result == CountPaginate"><a style="cursor: pointer;" ng-click="paginate(result + 1)">{{result + 1}}</a></li>
        <li>
            <a style="cursor: pointer;" id="paginateNext" aria-label="Next" ng-click="pageNext()">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
    </ul>
</nav>


<!-- Content -->
<div class="modal fade" ng-controller="galleryAdd" id="AddModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">فرم درج اطلاعات</h4>
            </div>
            <div class="modal-body">
                <form ng-submit="SubmitAdd()">
                    <div class="form-group">
                        <label for="recipient-name" class="control-label"> عنوان : </label>
                        <input type="text" name="title" ng-model="title"  class="form-control" >
                    </div>

                    <div class="form-group">
                        <label for="recipient-name" class="control-label"> مرتب سازی بر اساس : </label>
                        <input type="text" id="Addorder_list" name="order_list" ng-model="order_list" class="form-control" >
                    </div>

                    <div class="form-group">
                        <label for="recipient-name" class="control-label"> بر چسب ها(با علامت , از یکدیگر جدا کنید)  : </label>
                        <input type="text" id="Addmeta" name="meta" ng-model="meta" class="form-control" >
                    </div>                    

                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">انصراف</button>
                        <button type="reset" class="btn btn-danger">خالی کردن فیلدها</button>
                        <button type="submit" class="btn btn-primary">ذخیره اطلاعات</button>
                    </div>
                </form>  
            </div>

        </div>
    </div>
</div>
<!-- End Add Content  -->

<!-- Edit Blog Content -->
<button type="button" class="btn btn-primary hidden" id="EditBtnModal" data-toggle="modal" data-target="#EditModal">
    ویرایش انتخاب شده
</button>
<!-- Content -->
<div class="modal fade" ng-controller="galleryEdit" id="EditModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">ویرایش اطلاعات</h4>
            </div>
            <div class="modal-body">
                <form name="EditForm" ng-submit="SubmitEdit()">
                    <input type="text" ng-show="false" name="EditId" id="EditId" ng-model="EditId" testChange>
                    <div class="form-group">
                        <label for="recipient-name" class="control-label"> عنوان : </label>
                        <input type="text" id="EditTitle" name="title" ng-model="title" class="form-control" testChange>
                    </div>

                    <div class="form-group">
                        <label for="recipient-name" class="control-label"> مرتب سازی بر اساس : </label>
                        <input type="text" id="Editorder_list" name="order_list" ng-model="order_list" class="form-control" testChange >
                    </div>

                    <div class="form-group">
                        <label for="recipient-name" class="control-label"> بر چسب ها(با علامت , از یکدیگر جدا کنید)  : </label>
                        <input type="text" id="Editmeta" name="meta" ng-model="meta" class="form-control" >
                    </div> 

                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">انصراف</button>
                        <button type="submit" class="btn btn-primary SubmitEditForm">ذخیره اطلاعات</button>
                    </div>
                </form>  
            </div>

        </div>
    </div>
</div>
<!-- End Edit Content  -->


<!-- Show Blog Gallery -->
<button type="button" class="btn btn-primary hidden" id="EditBtnModal" data-toggle="modal" data-target="#EditModal">
    ویرایش انتخاب شده
</button>
<!-- Content -->
<div class="modal fade" ng-controller="galleryEdit" id="ViewModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">نمایش گالری</h4>
            </div>
            <div class="modal-body">
                <button type="button" class="btn btn-primary"  ng-click="mo=!mo">اظافه کردن عکس
                    <span class="glyphicon glyphicon-arrow-up" ng-show="mo"></span>
                    <span class="glyphicon glyphicon-arrow-down" ng-show="!mo"></span>
                </button>
                <div class="addimage" ng-controller="imageAdd" ng-show="mo">
                     <form ng-submit="SubmitAdd()">
                         <input type="text" ng-show="false" ng-model="gallery">
                    <div class="form-group">
                        <label for="recipient-name" class="control-label"> توضیحات عکس : </label>
                        <input type="text" name="alt" ng-model="alt" id="AddAlt"  class="form-control" >
                    </div>
                    
                    <div class="form-group">
                        <label for="recipient-name" class="control-label"> مرتب سازی بر اساس : </label>
                        <input type="text" id="Addorder_list" name="order_list" ng-model="order_list" class="form-control" >
                    </div>

                    <div class="form-group">
                        <input type="file" id="image" class="form-control" value="Select an image" placeholder="Select an image">
                        <textarea ng-show="false" id="AddSrcPic" class="well form-control" ></textarea>
                    </div>                    

                    <div class="modal-footer">
                        <button type="reset" class="btn btn-danger">خالی کردن فیلدها</button>
                        <button type="submit" class="btn btn-primary">ذخیره اطلاعات</button>
                    </div>
                </form>  
                </div>
                <div class="col-lg-12" >
                    <div class="row" id="ImageGalleryShow">
                        <div class="col-lg-3 col-md-3 col-sm-6 col-sm-6 ImageInfo" ng-repeat="entity in GalleryImage"
                             style="background-image: url('{{entity.src}}');" id="{{entity.id}}div">

                            <div class="header">
                                {{entity.alt| cut:true:20:' ...'}}
                            </div>
                            <div class="center">
                            </div>
                            <div class="footer">
                                <strong>توضیحات</strong> : {{entity.alt}}
                                <button onclick="DeleteImage('{{ entity.id}}')" class="btn btn-danger btn-sm pull-left bottom-left">Delete</button>
                            </div>

                        </div>
                    </div>
                </div>
                <p>&nbsp;</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">بستن</button>
            </div>
        </div>
    </div>
</div>
<!-- End Show Gallery  -->

<!-- Delete Blog Content -->
<button type="button" class="btn btn-primary hidden" id="DeleteBtnModal" data-toggle="modal" data-target="#DeleteModal">
    حذف انتخاب شده ها
</button>
<!-- Content -->
<div class="modal fade" ng-controller="galleryDelete" id="DeleteModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">ویرایش اطلاعات</h4>
            </div>
            <div class="modal-body">
                <form ng-submit="SubmitDelete()">
                    <input type="hidden" name="DeleteId" id="DeleteId" ng-model="DeleteId">
                    <p>
                        آیا از حذف اطلاعات مطمءن هستید؟
                    </p>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" id="CloseDeleteBtn" data-dismiss="modal">انصراف</button>
                        <button type="submit" class="btn btn-danger">حذف اطلاعات</button>
                    </div>
                </form>  
            </div>

        </div>
    </div>
</div>
<!-- End Delete Content  -->

<!-- Delete Image -->
<button type="button" class="btn btn-primary hidden" id="DeleteImageBtnModal" data-toggle="modal" data-target="#DeleteImageModal">
    حذف انتخاب شده ها
</button>
<!-- Content -->
<div class="modal fade" ng-controller="imageDelete" id="DeleteImageModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">حذف اطلاعات</h4>
            </div>
            <div class="modal-body">
                <form ng-submit="SubmitDelete()">
                    <input type="hidden" name="DeleteId" id="DeleteImageId" ng-model="DeleteId">
                    <p>
                        آیا این عکس حذف شود؟
                    </p>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" id="CloseDeleteImageBtn" data-dismiss="modal">انصراف</button>
                        <button type="submit" class="btn btn-danger">حذف اطلاعات</button>
                    </div>
                </form>  
            </div>

        </div>
    </div>
</div>
<!-- End Delete Image  -->



<script type="text/javascript">
                                // convert to base63 image
                                            jQuery(document).ready(function($){
                                $('#image').on('change', function(e){
                                $(this).base64img({
                                url: e.target.files[0],
                                        result: '#AddSrcPic'
                                });
                                });
                                });
                                
                                //Show tooltip
                                 $(function () {
                                    $('[data-toggle="tooltip"]').tooltip()
                                    })
                                    $(document).on('mouseenter', '.btnEditTitleTooltip', function() {
                            $('.btnEditTitleTooltip').tooltip();
                            });
                                    $(document).on('mouseenter', '.btnShowTitleTooltip', function() {
                            $('.btnShowTitleTooltip').tooltip();
                            });
                                    $(document).on('mouseenter', '.btnDeleteTitleTooltip', function() {
                            $('.btnDeleteTitleTooltip').tooltip();
                            });
                            
                                //Show Edit Textarea
                                    $(document).on('click', '.td', function() {
                            var id = $(this).attr('id');
                                    var value = $(this).attr('value');
                                    $('.' + id).css({'display': 'block',
                                    'position': 'absolute',
                                    'z-index': '9999999',
                                    'top': '0', 'right': '0',
                                    'height': $(this).css('height'), 'width': $(this).css('width')});
                            });
                            //Hidden Edit textarea
                                    $(document).on('dblclick', 'body', function() {
                            $('.TextAreaContent').css({'display': 'none'});
                            });
                                    //Edit Value Function with Show Modal
                                    function Edit(id, title, meta, order_list){
                                    var id2, title2, order_list2, meta2;
                                            meta2 = $('#Editmeta');
                                            meta2.val(meta);
                                            meta2.trigger('textArea');
                                            id2 = $('#EditId');
                                            id2.val(id);
                                            id2.trigger("input");
                                            title2 = $('#EditTitle');
                                            title2.val(title);
                                            title2.trigger("input");
//                                            CKEDITOR.instances.EditContent.setData();

                                            order_list2 = $('#Editorder_list');
                                            order_list2.val(order_list);
                                            order_list2.trigger('input');
                                            $('#EditBtnModal').click();
                                    }
                             //Edit value not Show Modal
                            function EditNotShow(id, title, meta, order_list){
                            var id2, title2, order_list2, meta2;
                                    meta2 = $('#Editmeta');
                                    meta2.val(meta);
                                    meta2.trigger('textArea');
                                    id2 = $('#EditId');
                                    id2.val(id);
                                    id2.trigger("input");
                                    title2 = $('#EditTitle');
                                    title2.val(title);
                                    title2.trigger("input");
                                    order_list2 = $('#Editorder_list');
                                    order_list2.val(order_list);
                                    order_list2.trigger('input');
                            }
                            
                            //delete
                            function Delete(id){
                            $('#DeleteId').val(id);
                                    $('#DeleteBtnModal').click();
                            }
                            //delete image
                            function DeleteImage(id){
                            $('#DeleteImageId').val(id);
                                    $('#DeleteImageBtnModal').click();
                            }
                            
                            //if change value textarea insert with this function
                            $(document).on('change', 'tr', function() {
                            change($(this).attr('id'));
                            });
                                    function change(id){
                                    var meta, id, title, order_list;
                                            var tr = $('#' + id);
                                            meta = $('.' + id + 'meta').val();
                                            title = $('.' + id + 'title').val();
                                            order_list = $('.' + id + 'order_list').val();
                                            $('.TextAreaContent').css({'display': 'none'});
                                            EditNotShow(id, title, meta, order_list);
                                            $('.SubmitEditForm').click();
                                    }


                            /// Show ///
                            function Show(id){
                            var id2;
                            }
                            // end Show
                            // Active Paginate 
                            $(document).on('click', '.paginate', function() {
                            $('.paginate').removeClass('active');
                                    $('.paginate').removeAttr('id');
                                    $(this).addClass('active');
                                    $(this).attr('id', 'active');
                            });
                                    $(document).on('click', '#paginateNext', function() {
                            $('.paginate').removeClass('active');
                                    var element = $('ul').find('#active').removeClass('active').removeAttr('id');
                                    $(element).next().addClass('active').attr('id', 'active');
                            });
                                    $(document).on('click', '#paginatePreview', function() {
                            $('.paginate').removeClass('active');
                                    var element = $('ul').find('#active').removeClass('active').removeAttr('id');
                                    $(element).prev().addClass('active').attr('id', 'active');
                            });</script>
