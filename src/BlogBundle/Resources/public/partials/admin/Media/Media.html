<h1>Content</h1>

<table class="table table-bordered table-striped table-hover" ng-click="text = false">
    <thead>
        <tr>
            <th>Title</th>
            <th>Content</th>
            <th>Visit</th>
            <th>Orderlist</th>
            <th>Createdat</th>
            <th>Updatedat</th>
            <th>Id</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody ng-repeat="entity in content">
        <tr id="{{entity.id}}" >
            <td class="td" id="{{ entity.id}}title"  value="{{entity.title}}" >{{ entity.title}}
                <textarea  name="title" class="{{ entity.id}}title form-control TextAreaContent" style="display: none">{{entity.title}}</textarea>
            </td>

            <td class="td" id="{{ entity.id}}content"  value="{{entity.content}}" >
                {{ entity.content}}
                <textarea name="content" class="{{ entity.id}}content form-control TextAreaContent" style="display: none">{{ entity.content}}</textarea>
            </td>

            <td class="td" id="{{ entity.id}}{{entity.visit}}" value="{{entity.visit}}" >
                {{ entity.visit}}
            </td>

            <td class="td" id="{{ entity.id}}orderList" value="{{entity.orderList}}" >
                {{ entity.orderList}}
                <textarea name="orderList" class="{{ entity.id}}orderList form-control TextAreaContent" style="display: none">{{ entity.orderList}}</textarea>
            </td>

            <td>{{ entity.createdAt}}</td>

            <td>{{ entity.updatedAt}}</td>

            <td><span ng-model="id">{{ entity.id}}</span></td>
            <td>
                <button onclick="Edit('{{entity.id}}','{{entity.title}}','{{entity.content}}','{{entity.orderList}}')" id="BtnEdit" class="btn btn-success btn-sm">Edit</button>
                <button onclick="Edit('{{entity.id}}','{{entity.title}}','{{entity.content}}','{{entity.orderList}}')" class="btn btn-info btn-sm">Show</button>
                <button onclick="Delete('{{ entity.id}}')" class="btn btn-danger btn-sm">Delete</button>
            </td>

        </tr>
    </tbody>
    <tfoot>
        <tr>
            <!-- Add Blog Content -->
    <button type="button" class="btn btn-primary btn-sm" id="modalAdd" data-toggle="modal" data-target="#AddModal">
        درج اطلاعات جدید
    </button>
</tr>
</tfoot>
</table>



<!-- Content -->
<div class="modal fade" ng-controller="contentAdd" id="AddModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">فرم درج اطلاعات</h4>
            </div>
            <div class="modal-body">
                <form ng-submit="SubmitAdd()">
                    <div class="form-group">
                        <label for="recipient-name" class="control-label"> عنوان : </label>
                        <input type="text" name="title" ng-model="title" class="form-control" >
                    </div>

                    <div class="form-group">
                        <label for="recipient-name" class="control-label"> مرتب سازی بر اساس : </label>
                        <input type="text" id="EditorderList" name="orderList" ng-model="orderList" class="form-control" >
                    </div>

                    <div class="form-group">
                        <label for="message-text" class="control-label"> محتوا : </label>
                        <textarea class="form-control" id="AddContentTextArea" name="content" ng-model="content" ></textarea>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">انصراف</button>
                        <button type="submit" class="btn btn-primary">ذخیره اطلاعات</button>
                    </div>
                </form>  
            </div>

        </div>
    </div>
</div>
<!-- End Add Content  -->

<!-- Edit Blog Content -->
<button type="button" class="btn btn-primary hidden" id="EditBtnModal" data-toggle="modal" data-target="#EditModal">
    ویرایش انتخاب شده
</button>
<!-- Content -->
<div class="modal fade" ng-controller="contentEdit" id="EditModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">ویرایش اطلاعات</h4>
            </div>
            <div class="modal-body">
                <form name="EditForm" ng-submit="SubmitEdit()">
                    <input type="hidden" name="EditId" id="EditId" ng-model="EditId">
                    <div class="form-group">
                        <label for="recipient-name" class="control-label"> عنوان : </label>
                        <input type="text" id="EditTitle" name="title" ng-model="title" class="form-control" >
                    </div>

                    <div class="form-group">
                        <label for="recipient-name" class="control-label"> مرتب سازی بر اساس : </label>
                        <input type="text" id="EditorderList" name="orderList" ng-model="orderList" class="form-control" >
                    </div>

                    <div class="form-group">
                        <label for="message-text" class="control-label"> محتوا : </label>
                        <textarea id="EditContent" name="content" ng-model="content" rows="10" cols="80">
                        </textarea>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">انصراف</button>
                        <button type="submit" class="btn btn-primary SubmitEditForm">ذخیره اطلاعات</button>
                    </div>
                </form>  
            </div>

        </div>
    </div>
</div>
<!-- End Edit Content  -->

<!-- Delete Blog Content -->
<button type="button" class="btn btn-primary hidden" id="DeleteBtnModal" data-toggle="modal" data-target="#DeleteModal">
    حذف انتخاب شده ها
</button>
<!-- Content -->
<div class="modal fade" ng-controller="contentDelete" id="DeleteModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">ویرایش اطلاعات</h4>
            </div>
            <div class="modal-body">
                <form ng-submit="SubmitDelete()">
                    <input type="hidden" name="DeleteId" id="DeleteId" ng-model="DeleteId">
                    <p>
                        آیا از حذف اطلاعات مطمءن هستید؟
                    </p>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">انصراف</button>
                        <button type="submit" class="btn btn-danger">حذف اطلاعات</button>
                    </div>
                </form>  
            </div>

        </div>
    </div>
</div>
<!-- End Delete Content  -->

<script type="text/javascript">
                                    $(document).on('click', '#modalAdd', function() {
                            try{
                            CKEDITOR.replace('AddContentTextArea',{language: 'fa'});
                            } catch (error){
                            console.log('ckEditor Already Exist');
                            }

                            });
                            $(document).on('click', '.td', function() {
                            var id = $(this).attr('id');
                                    var value = $(this).attr('value');
                                    $('.' + id).css({'display': 'block',
                                    'position': 'absolute',
                                    'z-index': '9999999',
                                    'top': '0', 'right': '0',
                                    'height': $(this).css('height'), 'width': $(this).css('width')});
                            });
                                    $(document).on('dblclick', 'body', function() {

                            $('.TextAreaContent').css({'display': 'none'});
//                            $('.BtnEditForm').click();
                            });
                                    function Edit(id, title, content, orderList){
                                    $('#EditId').val(id);
                                            $('#EditTitle').val(title);
                                            $('#EditContent').val(content);
                                            $('#EditorderList').val(orderList);
                                            $('#EditBtnModal').click();
                                    }

                            function EditNotShow(id, title, content, orderList){
                            $('#EditId').val(id);
                                    $('#EditTitle').val(title);
                                    $('#EditContent').val(content);
                                    $('#EditorderList').val(orderList);
                            }

                            function Delete(id){
                            $('#DeleteId').val(id);
                                    $('#DeleteBtnModal').click();
                            }
                            $(document).on('click', '#BtnEdit', function() {
                            // Replace the <textarea id="editor1"> with a CKEditor
                            // instance, using default configuration.
                            try{
                                            CKEDITOR.replace('EditContent',{language: 'fa'});
                                            } catch (error){
                                    console.log('ckEditor Already Exist');
                                    }
                            });
                                    $(document).on('change', 'tr', function() {
                            change($(this).attr('id'));
                            });
                                    function change(id){
                                    var content, id, title, orderList;
                                            var tr = $('#' + id);
                                            content = $('.' + id + 'content').val();
                                            title = $('.' + id + 'title').val();
                                            orderList = $('.' + id + 'orderList').val();
                                            $('.TextAreaContent').css({'display': 'none'});
                                            try{
                                            CKEDITOR.replace('EditContent',{language: 'fa'});
                                            } catch (error){
                                    console.log('ckEditor Already Exist');
                                    }
                                    EditNotShow(id, title, content, orderList);
                                            $('.SubmitEditForm').click();
                                    }
</script>
